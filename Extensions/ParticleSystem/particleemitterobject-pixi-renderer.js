var gdjs;(function(n){const p=(c,t,i)=>{const e=c.first;e.value=t,e.next=e.next||{time:1,value:0},e.next.value=i},s=class{constructor(t,i,e){this.started=!1;const r=t.getGame().getRenderer().getPIXIRenderer(),a=t.getGame().getImageManager();let m=PIXI.Texture.WHITE;r&&(e.rendererType==="Point"?m=a.getOrCreateDiskTexture(e.rendererParam1,r):e.rendererType==="Line"?m=a.getOrCreateRectangleTexture(e.rendererParam1,e.rendererParam2,r):e.textureParticleName?m=a.getOrCreateScaledTexture(e.textureParticleName,e.rendererParam1,e.rendererParam2,r):m=a.getOrCreateRectangleTexture(e.rendererParam1,e.rendererParam2,r));const g={ease:void 0,emit:void 0,lifetime:{min:e.particleLifeTimeMin,max:e.particleLifeTimeMax},frequency:e.flow<0?s.frequencyMinimumValue:1/e.flow,spawnChance:1,particlesPerWave:e.flow<0?e.maxParticleNb:1,maxParticles:e.maxParticleNb,emitterLifetime:s.computeLifetime(e.flow,e.tank),pos:{x:0,y:0},addAtBack:!1,behaviors:[{type:"alpha",config:{alpha:{isStepped:!1,list:[{time:0,value:e.particleAlpha1/255},{time:1,value:e.particleAlpha2/255}]}}},{type:"moveAcceleration",config:{accel:{x:e.particleGravityX,y:e.particleGravityY},minStart:e.emitterForceMin,maxStart:e.emitterForceMax,rotate:e.particleAngle1===0&&e.particleAngle2===0&&(e.particleGravityX!==0||e.particleGravityY!==0||e.emitterForceMin<0||e.emitterForceMax<0)}},{type:"scale",config:{scale:{isStepped:!1,list:[{time:0,value:e.particleSize1/100*(1+e.particleSizeRandomness1/100)},{time:1,value:e.particleSize2/100*(1+e.particleSizeRandomness2/100)}]}}},{type:"color",config:{color:{isStepped:!1,list:[{time:0,value:n.rgbToHex(e.particleRed1,e.particleGreen1,e.particleBlue1)},{time:1,value:n.rgbToHex(e.particleRed2,e.particleGreen2,e.particleBlue2)}]}}},{type:"rotation",config:{accel:0,minStart:-e.emitterAngleB/2,maxStart:e.emitterAngleB/2,maxSpeed:e.particleAngle2,minSpeed:e.particleAngle1}},{type:"blendMode",config:{blendMode:e.additive?"ADD":"NORMAL"}},{type:"textureSingle",config:{texture:m}},{type:"spawnShape",config:{type:"torus",data:{affectRotation:!1,innerRadius:0,radius:e.zoneRadius,x:0,y:0}}}]};this.renderer=new PIXI.Container,this.emitter=new PIXI.particles.Emitter(this.renderer,g),this.start();const l=t.getLayer(i.getLayer());l&&l.getRenderer().addRendererObject(this.renderer,i.getZOrder())}getRendererObject(){return this.renderer}update(t){const i=this.emitter.emit;this.emitter.update(t),!this.started&&i&&(this.started=!0)}setPosition(t,i){this.emitter.spawnPos.x=t,this.emitter.spawnPos.y=i}setAngle(t,i){const e=this.emitter.getBehavior("rotation");e.minStart=n.toRad(t),e.maxStart=n.toRad(i)}setForce(t,i){const e=this.emitter.getBehavior("moveAcceleration");e.maxStart=i||1e-6,e.minStart=t}setZoneRadius(t){const i=this.emitter.getBehavior("spawnShape");i.shape.radius=t}setLifeTime(t,i){this.emitter.minLifetime=t,this.emitter.maxLifetime=i}setGravity(t,i){const e=this.emitter.getBehavior("moveAcceleration");e.accel.x=t,e.accel.y=i,this._updateRotateFlagFromSpeed()}_updateRotateFlagFromSpeed(){const t=this.emitter.getBehavior("rotation"),i=this.emitter.getBehavior("moveAcceleration");i.rotate=t.minSpeed===0&&t.maxSpeed===0&&(i.accel.x!==0||i.accel.y!==0||i.minStart<0||i.maxStart<0)}setColor(t,i,e,r,a,m){const l=this.emitter.getBehavior("color").list.first,d=l.value;d.r=t,d.g=i,d.b=e,l.next=l.next||{time:1,value:{}};const u=l.next.value;u.r=r,u.g=a,u.b=m}setSize(t,i){const e=this.emitter.getBehavior("scale");p(e.list,t/100,i/100)}setParticleRotationSpeed(t,i){const e=this.emitter.getBehavior("rotation");e.minSpeed=n.toRad(t),e.maxSpeed=n.toRad(i),this._updateRotateFlagFromSpeed()}setMaxParticlesCount(t){this.emitter.maxParticles=t}setAdditiveRendering(t){const i=this.emitter.getBehavior("blendMode");i.blendMode=t?"ADD":"NORMAL"}setAlpha(t,i){const e=this.emitter.getBehavior("alpha");p(e.list,t/255,i/255)}setFlow(t,i){this.emitter.frequency=t<0?s.frequencyMinimumValue:1/t,this.emitter.emitterLifetime=s.computeLifetime(t,i)}resetEmission(t,i){this.setFlow(t,i);const e=this.emitter.emit;this.start(),e||this.stop()}isTextureNameValid(t,i){const e=i.getGame().getImageManager().getInvalidPIXITexture(),r=i.getGame().getImageManager().getPIXITexture(t);return r.valid&&r!==e}setTextureName(t,i){const e=i.getGame().getImageManager().getInvalidPIXITexture(),r=i.getGame().getImageManager().getPIXITexture(t);if(r.valid&&r!==e){const a=this.emitter.getBehavior("textureSingle");a.texture=r}}getParticleCount(){return this.emitter.particleCount}stop(){this.emitter.emit=!1}start(){this.emitter.emit=!0}recreate(){this.emitter.cleanup()}destroy(){this.emitter.destroy()}hasStarted(){return this.started}_mayHaveEndedEmission(){return this.emitter.frequency>s.frequencyMinimumValue&&this.emitter.emitterLifetime>=0&&!this.emitter.emit&&this.emitter._emitterLife===this.emitter.emitterLifetime}static computeLifetime(t,i){return i<0?-1:t<0?.001:(i+.1)/t}};let o=s;o.frequencyMinimumValue=1e-4,n.ParticleEmitterObjectPixiRenderer=o,n.ParticleEmitterObjectRenderer=o})(gdjs||(gdjs={}));
//# sourceMappingURL=particleemitterobject-pixi-renderer.js.map
